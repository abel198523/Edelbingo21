const BINGO_CARDS = {
  1: [[4,17,32,51,70],[11,22,42,48,63],[7,26,0,59,74],[2,19,35,53,66],[14,28,39,46,61]],
  2: [[1,18,33,52,71],[12,23,43,49,64],[8,27,0,60,75],[3,20,36,54,67],[15,29,40,47,62]],
  3: [[5,16,31,50,69],[10,21,41,55,72],[6,25,0,58,73],[9,24,34,56,68],[13,30,38,57,65]],
  4: [[2,19,35,53,66],[14,28,39,46,61],[4,17,0,51,70],[11,22,42,48,63],[7,26,32,59,74]],
  5: [[3,20,36,54,67],[15,29,40,47,62],[1,18,0,52,71],[12,23,43,49,64],[8,27,33,60,75]],
  6: [[9,24,34,56,68],[13,30,38,57,65],[5,16,0,50,69],[10,21,41,55,72],[6,25,31,58,73]],
  7: [[11,22,42,48,63],[7,26,32,59,74],[2,19,0,53,66],[14,28,39,46,61],[4,17,35,51,70]],
  8: [[12,23,43,49,64],[8,27,33,60,75],[3,20,0,54,67],[15,29,40,47,62],[1,18,36,52,71]],
  9: [[10,21,41,55,72],[6,25,31,58,73],[9,24,0,56,68],[13,30,38,57,65],[5,16,34,50,69]],
  10: [[14,28,39,46,61],[4,17,35,51,70],[11,22,0,48,63],[7,26,32,59,74],[2,19,42,53,66]],
  11: [[15,29,40,47,62],[1,18,36,52,71],[12,23,0,49,64],[8,27,33,60,75],[3,20,43,54,67]],
  12: [[13,30,38,57,65],[5,16,34,50,69],[10,21,0,55,72],[6,25,31,58,73],[9,24,41,56,68]],
  13: [[7,26,32,59,74],[2,19,42,53,66],[14,28,0,46,61],[4,17,35,51,70],[11,22,39,48,63]],
  14: [[8,27,33,60,75],[3,20,43,54,67],[15,29,0,47,62],[1,18,36,52,71],[12,23,40,49,64]],
  15: [[6,25,31,58,73],[9,24,41,56,68],[13,30,0,57,65],[5,16,34,50,69],[10,21,38,55,72]],
  16: [[1,16,31,46,61],[8,23,38,53,68],[4,20,0,50,66],[11,27,43,57,73],[15,30,45,60,75]],
  17: [[2,17,32,47,62],[9,24,39,54,69],[5,21,0,51,67],[12,28,43,58,74],[14,29,45,59,75]],
  18: [[3,18,33,48,63],[10,25,40,55,70],[6,22,0,52,68],[13,29,45,59,75],[15,30,43,60,73]],
  19: [[4,19,34,49,64],[11,26,41,56,71],[7,23,0,53,69],[14,30,44,60,74],[1,16,42,46,72]],
  20: [[5,20,35,50,65],[12,27,42,57,72],[8,24,0,54,70],[15,28,43,58,73],[2,17,41,47,71]],
  21: [[6,21,36,51,66],[13,28,43,58,73],[9,25,0,55,71],[1,16,42,46,72],[3,18,40,48,70]],
  22: [[7,22,37,52,67],[14,29,44,59,74],[10,26,0,56,72],[2,17,41,47,71],[4,19,39,49,69]],
  23: [[8,23,38,53,68],[15,30,45,60,75],[11,27,0,57,73],[3,18,40,48,70],[5,20,31,50,66]],
  24: [[9,24,39,54,69],[1,16,31,46,61],[12,28,0,58,74],[4,19,32,49,67],[6,21,37,51,67]],
  25: [[10,25,40,55,70],[2,17,32,47,62],[13,29,0,59,75],[5,20,38,50,68],[7,22,36,52,66]],
  26: [[11,26,41,56,71],[3,18,33,48,63],[14,30,0,60,74],[6,21,37,51,67],[8,23,35,53,65]],
  27: [[12,27,42,57,72],[4,19,34,49,64],[15,28,0,46,73],[7,22,36,52,66],[9,24,15,54,75]],
  28: [[13,28,43,58,73],[5,20,35,50,65],[1,16,0,47,61],[8,23,31,53,69],[10,25,33,55,63]],
  29: [[14,29,44,59,74],[6,21,36,51,66],[2,17,0,48,62],[9,24,34,54,64],[11,26,32,56,75]],
  30: [[15,30,45,60,75],[7,22,37,52,67],[3,18,0,49,63],[10,25,33,55,68],[12,27,31,57,61]],
  31: [[1,17,33,49,65],[6,22,38,54,70],[11,27,0,59,75],[3,19,35,51,67],[8,24,40,56,72]],
  32: [[2,18,34,50,66],[7,23,39,55,71],[12,28,0,60,74],[4,20,36,52,68],[9,25,41,57,73]],
  33: [[3,19,35,51,67],[8,24,40,56,72],[13,29,0,46,61],[5,21,37,53,69],[10,26,42,58,74]],
  34: [[4,20,36,52,68],[9,25,41,57,73],[14,30,0,47,62],[6,22,38,54,70],[11,27,43,59,75]],
  35: [[5,21,37,53,69],[10,26,42,58,74],[15,28,0,48,63],[7,23,39,55,71],[12,1,44,60,75]],
  36: [[6,22,38,54,70],[11,27,43,59,75],[1,16,0,49,64],[8,24,40,56,72],[13,29,45,46,61]],
  37: [[7,23,39,55,71],[12,28,44,60,74],[2,17,0,50,65],[9,25,41,57,73],[14,30,35,47,62]],
  38: [[8,24,40,56,72],[13,29,45,46,61],[3,18,0,51,66],[10,26,42,58,74],[15,28,43,48,63]],
  39: [[9,25,41,57,73],[14,30,44,47,62],[4,19,0,52,67],[11,27,43,59,75],[1,16,42,49,64]],
  40: [[10,26,42,58,74],[15,28,43,48,63],[5,20,0,53,68],[12,1,44,60,75],[2,17,41,50,65]],
  41: [[11,27,43,59,75],[1,16,42,49,64],[6,21,0,54,69],[13,29,45,46,61],[3,18,40,51,66]],
  42: [[12,28,44,60,74],[2,17,41,50,65],[7,22,0,55,70],[14,30,35,47,62],[4,19,39,52,67]],
  43: [[13,29,45,46,61],[3,18,40,51,66],[8,23,0,56,71],[15,28,43,48,63],[5,20,38,53,68]],
  44: [[14,30,44,47,62],[4,19,39,52,67],[9,24,0,57,72],[1,16,42,49,64],[6,21,37,54,69]],
  45: [[15,28,43,48,63],[5,20,38,53,68],[10,25,0,58,73],[2,17,41,50,65],[7,22,36,55,70]],
  46: [[1,16,42,49,64],[6,21,37,54,69],[11,26,0,59,74],[3,18,40,51,66],[8,23,35,56,71]],
  47: [[2,17,41,50,65],[7,22,36,55,70],[12,27,0,60,75],[4,19,39,52,67],[9,24,34,57,72]],
  48: [[3,18,40,51,66],[8,23,35,56,71],[13,28,0,46,61],[5,20,38,53,68],[10,25,33,58,73]],
  49: [[4,19,39,52,67],[9,24,34,57,72],[14,29,0,47,62],[6,21,37,54,69],[11,26,32,59,74]],
  50: [[5,20,38,53,68],[10,25,33,58,73],[15,30,0,48,63],[7,22,36,55,70],[12,27,31,60,75]],
  51: [[1,18,35,52,69],[9,26,43,60,72],[4,21,0,55,66],[12,29,38,47,74],[7,24,31,54,61]],
  52: [[2,19,36,53,70],[10,27,44,46,73],[5,22,0,56,67],[13,30,39,48,75],[8,25,32,55,62]],
  53: [[3,20,37,54,71],[11,28,45,47,74],[6,23,0,57,68],[14,16,40,49,61],[9,26,33,56,63]],
  54: [[4,21,38,55,72],[12,29,31,48,75],[7,24,0,58,69],[15,17,41,50,62],[10,27,34,57,64]],
  55: [[5,22,39,56,73],[13,30,32,49,61],[8,25,0,59,70],[1,18,42,51,63],[11,28,35,58,65]],
  56: [[6,23,40,57,74],[14,16,33,50,62],[9,26,0,60,71],[2,19,43,52,64],[12,29,36,59,66]],
  57: [[7,24,41,58,75],[15,17,34,51,63],[10,27,0,46,72],[3,20,44,53,65],[13,30,37,60,67]],
  58: [[8,25,42,59,61],[1,18,35,52,64],[11,28,0,47,73],[4,21,45,54,66],[14,16,38,46,68]],
  59: [[9,26,43,60,62],[2,19,36,53,65],[12,29,0,48,74],[5,22,31,55,67],[15,17,39,47,69]],
  60: [[10,27,44,46,63],[3,20,37,54,66],[13,30,0,49,75],[6,23,32,56,68],[1,18,40,48,70]],
  61: [[11,28,45,47,64],[4,21,38,55,67],[14,16,0,50,61],[7,24,33,57,69],[2,19,41,49,71]],
  62: [[12,29,31,48,65],[5,22,39,56,68],[15,17,0,51,62],[8,25,34,58,70],[3,20,42,50,72]],
  63: [[13,30,32,49,66],[6,23,40,57,69],[1,18,0,52,63],[9,26,35,59,71],[4,21,43,51,73]],
  64: [[14,16,33,50,67],[7,24,41,58,70],[2,19,0,53,64],[10,27,36,60,72],[5,22,44,52,74]],
  65: [[15,17,34,51,68],[8,25,42,59,71],[3,20,0,54,65],[11,28,37,46,73],[6,23,45,53,75]],
  66: [[1,19,37,55,73],[7,25,43,48,66],[13,28,0,52,70],[4,22,40,58,63],[10,16,34,46,61]],
  67: [[2,20,38,56,74],[8,26,44,49,67],[14,29,0,53,71],[5,23,41,59,64],[11,17,35,47,62]],
  68: [[3,21,39,57,75],[9,27,45,50,68],[15,30,0,54,72],[6,24,42,60,65],[12,18,36,48,63]],
  69: [[4,22,40,58,61],[10,28,31,51,69],[1,16,0,55,73],[7,25,43,46,66],[13,19,37,49,64]],
  70: [[5,23,41,59,62],[11,29,32,52,70],[2,17,0,56,74],[8,26,44,47,67],[14,20,38,50,65]],
  71: [[6,24,42,60,63],[12,30,33,53,71],[3,18,0,57,75],[9,27,45,48,68],[15,21,39,51,66]],
  72: [[7,25,43,46,64],[13,16,34,54,72],[4,19,0,58,61],[10,28,31,49,69],[1,22,40,52,67]],
  73: [[8,26,44,47,65],[14,17,35,55,73],[5,20,0,59,62],[11,29,32,50,70],[2,23,41,53,68]],
  74: [[9,27,45,48,66],[15,18,36,56,74],[6,21,0,60,63],[12,30,33,51,71],[3,24,42,54,69]],
  75: [[10,28,31,49,67],[1,19,37,57,75],[7,22,0,46,64],[13,16,34,52,72],[4,25,43,55,70]],
  76: [[11,29,32,50,68],[2,20,38,58,61],[8,23,0,47,65],[14,17,35,53,73],[5,26,44,56,71]],
  77: [[12,30,33,51,69],[3,21,39,59,62],[9,24,0,48,66],[15,18,36,54,74],[6,27,45,57,72]],
  78: [[13,16,34,52,70],[4,22,40,60,63],[10,25,0,49,67],[1,19,37,55,75],[7,28,31,58,73]],
  79: [[14,17,35,53,71],[5,23,41,46,64],[11,26,0,50,68],[2,20,38,56,61],[8,29,32,59,74]],
  80: [[15,18,36,54,72],[6,24,42,47,65],[12,27,0,51,69],[3,21,39,57,62],[9,30,33,60,75]],
  81: [[1,20,39,58,72],[5,24,43,47,66],[9,28,0,51,70],[13,17,36,55,74],[2,21,40,59,63]],
  82: [[2,21,40,59,73],[6,25,44,48,67],[10,29,0,52,71],[14,18,37,56,75],[3,22,41,60,64]],
  83: [[3,22,41,60,74],[7,26,45,49,68],[11,30,0,53,72],[15,19,38,57,61],[4,23,42,46,65]],
  84: [[4,23,42,46,75],[8,27,31,50,69],[12,16,0,54,73],[1,20,39,58,62],[5,24,43,47,66]],
  85: [[5,24,43,47,61],[9,28,32,51,70],[13,17,0,55,74],[2,21,40,59,63],[6,25,44,48,67]],
  86: [[6,25,44,48,62],[10,29,33,52,71],[14,18,0,56,75],[3,22,41,60,64],[7,26,45,49,68]],
  87: [[7,26,45,49,63],[11,30,34,53,72],[15,19,0,57,61],[4,23,42,46,65],[8,27,31,50,69]],
  88: [[8,27,31,50,64],[12,16,35,54,73],[1,20,0,58,62],[5,24,43,47,66],[9,28,32,51,70]],
  89: [[9,28,32,51,65],[13,17,36,55,74],[2,21,0,59,63],[6,25,44,48,67],[10,29,33,52,71]],
  90: [[10,29,33,52,66],[14,18,37,56,75],[3,22,0,60,64],[7,26,45,49,68],[11,30,34,53,72]],
  91: [[11,30,34,53,67],[15,19,38,57,61],[4,23,0,46,65],[8,27,31,50,69],[12,16,35,54,73]],
  92: [[12,16,35,54,68],[1,20,39,58,62],[5,24,0,47,66],[9,28,32,51,70],[13,17,36,55,74]],
  93: [[13,17,36,55,69],[2,21,40,59,63],[6,25,0,48,67],[10,29,33,52,71],[14,18,37,56,75]],
  94: [[14,18,37,56,70],[3,22,41,60,64],[7,26,0,49,68],[11,30,34,53,72],[15,19,38,57,61]],
  95: [[15,19,38,57,71],[4,23,42,46,65],[8,27,0,50,69],[12,16,35,54,73],[1,20,39,58,62]],
  96: [[1,21,41,46,72],[4,24,44,49,75],[7,27,0,52,63],[10,30,35,55,66],[13,18,38,58,69]],
  97: [[2,22,42,47,73],[5,25,45,50,61],[8,28,0,53,64],[11,16,36,56,67],[14,19,39,59,70]],
  98: [[3,23,43,48,74],[6,26,31,51,62],[9,29,0,54,65],[12,17,37,57,68],[15,20,40,60,71]],
  99: [[4,24,44,49,75],[7,27,32,52,63],[10,30,0,55,66],[13,18,38,58,69],[1,21,41,46,72]],
  100: [[5,25,45,50,61],[8,28,33,53,64],[11,16,0,56,67],[14,19,39,59,70],[2,22,42,47,73]]
};

function validateBingo(cardId, calledNumbers) {
    const cardData = BINGO_CARDS[cardId];
    if (!cardData) return null;
    
    const calledSet = new Set(calledNumbers.map(n => Number(n)));
    calledSet.add(0); // FREE space is always considered called
    
    // Check rows
    for (let row = 0; row < 5; row++) {
        let rowComplete = true;
        let indices = [];
        for (let col = 0; col < 5; col++) {
            const num = Number(cardData[row][col]);
            indices.push(row * 5 + col);
            if (num !== 0 && !calledSet.has(num)) {
                rowComplete = false;
                break;
            }
        }
        if (rowComplete) return { type: 'row', index: row, indices };
    }
    
    // Check columns
    for (let col = 0; col < 5; col++) {
        let colComplete = true;
        let indices = [];
        for (let row = 0; row < 5; row++) {
            const num = Number(cardData[row][col]);
            indices.push(row * 5 + col);
            if (num !== 0 && !calledSet.has(num)) {
                colComplete = false;
                break;
            }
        }
        if (colComplete) return { type: 'column', index: col, indices };
    }
    
    // Check diagonals
    let diag1Complete = true;
    let diag1Indices = [];
    let diag2Complete = true;
    let diag2Indices = [];
    for (let i = 0; i < 5; i++) {
        const num1 = Number(cardData[i][i]);
        diag1Indices.push(i * 5 + i);
        if (num1 !== 0 && !calledSet.has(num1)) diag1Complete = false;
        
        const num2 = Number(cardData[i][4 - i]);
        diag2Indices.push(i * 5 + (4 - i));
        if (num2 !== 0 && !calledSet.has(num2)) diag2Complete = false;
    }
    
    if (diag1Complete) return { type: 'diagonal', index: 1, indices: diag1Indices };
    if (diag2Complete) return { type: 'diagonal', index: 2, indices: diag2Indices };
    
    // Check corners
    const cornerIndices = [0, 4, 20, 24];
    let cornersComplete = true;
    for (const idx of cornerIndices) {
        const r = Math.floor(idx / 5);
        const c = idx % 5;
        const num = Number(cardData[r][c]);
        if (num !== 0 && !calledSet.has(num)) {
            cornersComplete = false;
            break;
        }
    }
    if (cornersComplete) return { type: 'corners', indices: cornerIndices };
    
    return null;
}

module.exports = { BINGO_CARDS, validateBingo };
